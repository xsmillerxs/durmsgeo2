<!doctype html>
<html lang="pt-BR" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mapa de Risco - Durmsgeo IFRN</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    
  <link rel="stylesheet" href="css/style.css">

  <style>
    :root {
      /* --- VARI√ÅVEIS DE CORES --- */
      
      /* Modo Escuro (Padr√£o) */
      --primary: #05df34;        
      --primary-dark: #004d40;
      --accent: #05df34;         
      
      --bg-body: #000000;
      
      /* Cores espec√≠ficas solicitadas */
      --bg-section-map: #000000;   /* Fundo PRETO no Georreferenciamento */
      --bg-section-chart: #18181b; /* Fundo CINZA na Frequ√™ncia */
      --bg-section-info: #000000;  /* Fundo da √∫ltima se√ß√£o */

      --bg-card: #1c1c1c;        
      
      --text-main: #f1f5f9;        
      --text-muted: #94a3b8;       
      
      --nav-bg: rgba(0, 0, 0, 0.85);
      --nav-border: rgba(255,255,255,0.15);
      --nav-text: #f1f5f9;

      --card-border: rgba(255, 255, 255, 0.15);
      --shadow-card: 0 10px 15px -3px rgba(0, 0, 0, 0.8);
      --chart-grid: rgba(255,255,255,0.1);
      --chart-text: #94a3b8;
      
      --map-bg: #000000; 
      --popup-bg: #1c1c1c;
      --popup-text: #f1f5f9;
      
      --radius: 16px;
    }

    [data-theme="light"] {
      --primary: #00a82d; 
      --primary-dark: #00332a;
      --accent: #05df34; 

      --bg-body: #ffffff;
      
      /* Cores claras para o modo light */
      --bg-section-map: #ffffff;
      --bg-section-chart: #f4f4f5; /* Cinza bem clarinho */
      --bg-section-info: #ffffff;

      --bg-card: #ffffff;

      --text-main: #1e293b;
      --text-muted: #64748b;

      --nav-bg: rgba(255, 255, 255, 0.9);
      --nav-border: rgba(0,0,0,0.1);
      --nav-text: #1e293b;

      --card-border: rgba(0, 0, 0, 0.1);
      --shadow-card: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      --chart-grid: rgba(0,0,0,0.1);
      --chart-text: #64748b;
      
      --map-bg: #f0f0f0;
      --popup-bg: #ffffff;
      --popup-text: #333333;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--bg-body);
      color: var(--text-main);
      line-height: 1.6;
      overflow-x: hidden;
      transition: background-color 0.4s ease, color 0.4s ease, zoom 0.3s ease;
    }

    .container { max-width: 1100px; margin: 0 auto; padding: 0 20px; }
    h2 { font-size: 2.2rem; margin-bottom: 25px; color: var(--primary); transition: color 0.3s; }
    
    .section { padding: 80px 0; transition: background-color 0.4s; }

    .site-nav {
      position: sticky; top: 20px; margin: 0 auto; width: 90%; max-width: 1000px;
      background: var(--nav-bg); backdrop-filter: blur(12px); padding: 15px 30px;
      border-radius: 50px; display: flex; justify-content: center; gap: 25px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); z-index: 1000; 
      border: 1px solid var(--nav-border);
      transition: background 0.4s, border 0.4s;
    }
    .site-nav a { text-decoration: none; color: var(--nav-text); font-weight: 600; font-size: 0.95rem; transition: 0.3s; position: relative; }
    .site-nav a:hover { color: var(--primary); }
    .site-nav a::after { content: ''; position: absolute; width: 0; height: 2px; bottom: -4px; left: 0; background-color: var(--accent); transition: width 0.3s; }
    .site-nav a:hover::after { width: 100%; }

    .mobile-menu-btn {
      display: none;
      position: fixed; top: 20px; left: 20px; z-index: 3000;
      background: var(--nav-bg); backdrop-filter: blur(10px);
      border: 1px solid var(--nav-border);
      color: var(--primary);
      width: 50px; height: 50px; border-radius: 12px;
      cursor: pointer; align-items: center; justify-content: center;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      transition: transform 0.2s, background 0.3s;
    }
    .mobile-menu-btn:hover { transform: scale(1.05); background: var(--bg-card); }
    .mobile-menu-btn svg { width: 28px; height: 28px; fill: currentColor; }

    .mobile-backdrop {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.6); z-index: 3001;
      opacity: 0; visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s;
      backdrop-filter: blur(3px);
    }
    .mobile-backdrop.active { opacity: 1; visibility: visible; }

    .mobile-menu-overlay {
      position: fixed; top: 0; left: 0; width: 280px; height: 100%;
      background: var(--bg-card);
      border-right: 1px solid var(--card-border);
      z-index: 3002;
      padding: 30px 20px;
      display: flex; flex-direction: column; gap: 20px;
      box-shadow: 5px 0 25px rgba(0,0,0,0.5);
      transform: translateX(-100%);
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .mobile-menu-overlay.active { transform: translateX(0); }
    
    /* Links do Mobile */
    .mobile-menu-overlay h3 {
      color: var(--primary); margin-bottom: 20px; font-size: 1.5rem;
      border-bottom: 1px solid var(--nav-border); padding-bottom: 15px;
    }
    .mobile-menu-overlay a {
      text-decoration: none; color: var(--text-main); font-size: 1.1rem;
      font-weight: 600; padding: 10px; border-radius: 8px;
      transition: background 0.2s, color 0.2s;
    }
    .mobile-menu-overlay a:hover {
      background: rgba(255,255,255,0.05); color: var(--primary); padding-left: 15px;
    }

    /* --- HERO --- */
    .hero-outer {
      background: radial-gradient(circle at top right, #00695c, #004d40);
      color: white; padding: 40px 0 80px 0; position: relative; overflow: hidden;
      border-bottom-left-radius: 60px; border-bottom-right-radius: 60px; border-bottom: 4px solid var(--accent);
    }
    .blob { position: absolute; background: rgba(255, 255, 255, 0.05); border-radius: 50%; animation: float 20s infinite ease-in-out; z-index: 0; }
    .blob-1 { width: 400px; height: 400px; top: -100px; left: -100px; }
    .blob-2 { width: 300px; height: 300px; bottom: -50px; right: -50px; }
    @keyframes float { 0%, 100% { transform: translate(0, 0); } 50% { transform: translate(30px, 40px); } }

    .hero { display: flex; align-items: center; justify-content: space-between; max-width: 1200px; margin: 0 auto; padding: 40px 20px; position: relative; z-index: 1; gap: 40px; flex-wrap: wrap; }
    .hero-content { flex: 1; min-width: 300px; }
    
    .brand-logos { display: flex; gap: 20px; margin-bottom: 30px; align-items: center; }
    .brand-logos img { height: 60px; filter: drop-shadow(0 4px 6px rgba(0,0,0,0.2)); }
    
    .hero-title { 
      font-size: 3rem; font-weight: 900; line-height: 1.1; margin-bottom: 15px; 
      background: linear-gradient(to right, #ffffff, #05df34); 
      background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; 
    }
    
    .hero-sub { font-size: 1.2rem; color: rgba(255,255,255,0.9); margin-bottom: 40px; max-width: 500px; }
    .hero-visual img { max-width: 100%; height: auto; animation: gentle-float 6s ease-in-out infinite; }
    @keyframes gentle-float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }
    
    .btn { display: inline-block; transition: transform 0.2s; cursor: pointer; }
    .btn:hover { transform: scale(1.05); }

    /* --- MAPA --- */
    .map-wrapper {
      position: relative; width: 100%; max-width: 1000px; margin: 0 auto;
      border-radius: var(--radius); overflow: hidden; 
      box-shadow: var(--shadow-card); border: 2px solid var(--accent);
      background-color: var(--map-bg); transition: box-shadow 0.3s, background-color 0.4s;
    }

    .map-container {
      position: relative; width: 100%; transform-origin: center;
      cursor: grab; transition: transform 0.1s linear;
    }
    .map-container:active { cursor: grabbing; }
    .base-map { width: 100%; height: auto; display: block; object-fit: cover; pointer-events: none; }

    .map-zoom-controls {
      position: absolute; bottom: 20px; right: 20px;
      display: flex; flex-direction: column; gap: 10px; z-index: 100;
    }
    .map-zoom-btn {
      width: 40px; height: 40px; border-radius: 8px;
      background: rgba(0,0,0,0.8); border: 1px solid var(--primary);
      color: var(--primary); font-size: 1.5rem; font-weight: bold;
      cursor: pointer; display: flex; align-items: center; justify-content: center;
      transition: 0.2s;
    }
    .map-zoom-btn:hover { background: var(--primary); color: #000; }

    .hotspot {
      position: absolute; width: 24px; height: 24px;
      background: rgba(231, 76, 60, 0.9);
      border: 2px solid #fff; border-radius: 50%;
      cursor: pointer; z-index: 10;
      transform: translate(-50%, -50%);
      padding: 0; animation: pulse 2s infinite;
    }
    .hotspot:hover { background: #ff0000; transform: translate(-50%, -50%) scale(1.3); z-index: 20; }
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.7); }
      70% { box-shadow: 0 0 0 10px rgba(231, 76, 60, 0); }
      100% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0); }
    }

    .hover-preview {
      display: none; position: absolute; bottom: 35px; left: 50%;
      transform: translateX(-50%); width: 200px;
      background: var(--popup-bg); color: var(--popup-text);
      border: 1px solid var(--card-border); padding: 10px;
      border-radius: 8px; box-shadow: 0 10px 25px rgba(0,0,0,0.8);
      z-index: 30; text-align: center; line-height: 1.4;
    }
    .hover-preview::after {
      content: ''; position: absolute; top: 100%; left: 50%;
      margin-left: -8px; border-width: 8px; border-style: solid;
      border-color: var(--popup-bg) transparent transparent transparent;
    }
    .hover-preview img { width: 100%; height: 100px; object-fit: cover; border-radius: 4px; margin-bottom: 5px; display: block; }
    .hover-preview strong { display: block; font-size: 0.9rem; color: var(--primary); }
    .hover-preview p { font-size: 0.75rem; color: var(--text-muted); margin: 0; }
    .hotspot:hover .hover-preview { display: block; }

    .chart-container {
      background: var(--bg-card); padding: 20px;
      border-radius: var(--radius); box-shadow: var(--shadow-card);
      margin-top: 30px; border: 1px solid var(--card-border);
      transition: background-color 0.4s, border-color 0.4s;
    }
    .risk-list { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-top: 30px; }
    .risk-item {
      background: var(--bg-card); padding: 25px;
      border-radius: var(--radius); border-left: 5px solid var(--accent);
      box-shadow: var(--shadow-card);
      transition: background-color 0.4s;
      border: 1px solid var(--card-border);
    }
    .risk-item strong { color: var(--accent); display: block; margin-bottom: 5px; }

    .gallery-modal {
      display: none; position: fixed; top: 0; left: 0;
      width: 100%; height: 100%; background: rgba(0,0,0,0.9);
      z-index: 9999; justify-content: center; align-items: center;
      padding: 20px; backdrop-filter: blur(5px);
    }
    .modal-content {
      background: #1e293b; padding: 25px; border-radius: 16px;
      max-width: 800px; width: 100%; position: relative;
      text-align: center; border: 1px solid rgba(255,255,255,0.1); 
      max-height: 90vh; overflow-y: auto;
    }
    .modal-close {
      position: absolute; top: 15px; right: 20px;
      font-size: 2rem; cursor: pointer; color: #fff; background: none; border: none;
    }
    .gallery-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 20px; }
    
    /* --- CORRE√á√ÉO AQUI --- */
    .gallery-grid img { 
      width: 100%; 
      height: auto; /* Altura autom√°tica para n√£o esticar/cortar */
      max-height: 500px; /* Limite de altura para n√£o ficar gigante */
      object-fit: contain; /* Garante que a imagem inteira apare√ßa */
      border-radius: 8px; 
      border: 2px solid transparent; 
    }
    /* -------------------- */
    
    .gallery-grid img:hover { border-color: var(--accent); }

    .footer { background: #050b14; color: #64748b; text-align: center; padding: 40px 20px; border-top: 1px solid rgba(255,255,255,0.05); }

    /* CONTROLES FLUTUANTES */
    .controls-wrapper { 
      position: fixed; bottom: 30px; right: 20px; z-index: 2000; 
      display: flex; flex-direction: column; gap: 15px; align-items: center;
    }
    .btn-float { 
      width: 50px; height: 50px; border-radius: 50%; 
      background: var(--primary); border: none; color: white; 
      cursor: pointer; display: flex; align-items: center; justify-content: center; 
      box-shadow: 0 4px 10px rgba(0,0,0,0.3); transition: 0.2s; 
      position: relative;
    }
    .btn-float:hover { transform: scale(1.1); background: var(--primary-dark); }
    .btn-float svg { width: 24px; height: 24px; fill: currentColor; }

    .global-zoom-menu {
      display: none; flex-direction: column; gap: 8px; margin-bottom: 5px;
      background: rgba(0,0,0,0.8); padding: 8px; border-radius: 25px; border: 1px solid var(--primary);
    }
    .global-zoom-menu.active { display: flex; animation: fadeIn 0.3s; }
    .zoom-option-btn {
      width: 35px; height: 35px; border-radius: 50%;
      background: #333; color: var(--primary); border: 1px solid var(--primary);
      font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 1.2rem;
    }
    .zoom-option-btn:hover { background: var(--primary); color: #000; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .theme-icon-sun { display: none; }
    [data-theme="light"] .theme-icon-moon { display: none; }
    [data-theme="light"] .theme-icon-sun { display: block; }
    [data-theme="light"] .btn-float.theme-btn { color: #fff; } 

    /* --- MEDIA QUERIES --- */
    /* Mobile Menu Breakpoint (992px) */
    @media (max-width: 992px) {
      .site-nav { display: none; } /* Esconde menu desktop */
      .mobile-menu-btn { display: flex; } /* Mostra bot√£o hamb√∫rguer */
      
      .hero-title { font-size: 2.5rem; }
      .hero { flex-direction: column-reverse; text-align: center; }
      .hover-preview { display: none !important; }
    }

    @media (max-width: 768px) { 
      .hero-title { font-size: 2.2rem; } 
    }
  </style>
</head>

<body>

  <button class="mobile-menu-btn" onclick="toggleMobileMenu()" aria-label="Abrir Menu">
    <svg viewBox="0 0 24 24"><path d="M3 6h18v2H3V6zm0 5h18v2H3v-2zm0 5h18v2H3v-2z"/></svg>
  </button>

  <div class="mobile-backdrop" id="mobileBackdrop" onclick="toggleMobileMenu()"></div>

  <div class="mobile-menu-overlay" id="mobileMenu">
    <h3>Menu</h3>
    <a href="index.html" onclick="toggleMobileMenu()">In√≠cio</a>
    <a href="quem-somos.html" onclick="toggleMobileMenu()">Quem Somos</a>
    <a href="entenda-problema.html" onclick="toggleMobileMenu()">Problemas</a>
    <a href="educacao.html" onclick="toggleMobileMenu()">Educa√ß√£o</a> 
    <a href="solucao.html" onclick="toggleMobileMenu()">Solu√ß√µes</a>
    <a href="mapa-risco.html" onclick="toggleMobileMenu()" style="color:var(--primary);">Mapa de Risco</a>
    <a href="quiz.html" onclick="toggleMobileMenu()">Quiz</a>
  </div>
  <div class="controls-wrapper">
    <button class="btn-float theme-btn" id="themeToggle" title="Alternar Tema">
      <svg class="theme-icon-moon" viewBox="0 0 24 24"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"/></svg>
      <svg class="theme-icon-sun" viewBox="0 0 24 24"><path d="M6.76 4.84l-1.8-1.79-1.41 1.41 1.79 1.79 1.42-1.41zM4 10.5H1v2h3v-2zm9-9.95h-2V3.5h2V.55zm7.45 3.91l-1.41-1.41-1.79 1.79 1.41 1.41 1.79-1.79zm-3.21 13.7l1.79 1.8 1.41-1.41-1.8-1.79-1.4 1.4zM20 10.5v2h3v-2h-3zm-8-5c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6zm-1 16.95h2V19.5h-2v2.95zm-7.45-3.91l1.41 1.41 1.79-1.8-1.41-1.41-1.79 1.8z"/></svg>
    </button>
    
    <div id="globalZoomMenu" class="global-zoom-menu">
        <button class="zoom-option-btn" onclick="changeGlobalZoom(10)" title="Aumentar P√°gina">+</button>
        <button class="zoom-option-btn" onclick="resetGlobalZoom()" title="Resetar P√°gina">‚Ü∫</button>
        <button class="zoom-option-btn" onclick="changeGlobalZoom(-10)" title="Diminuir P√°gina">-</button>
    </div>

    <button class="btn-float" title="Zoom da P√°gina" onclick="toggleZoomMenu()">
       <svg viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
    </button>

    <button class="btn-float" title="Comando de Voz">
      <svg viewBox="0 0 24 24"><path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/><path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/></svg>
    </button>
  </div>

  <header class="hero-outer">
    <div class="blob blob-1"></div>
    <div class="blob blob-2"></div>

    <nav class="site-nav" role="navigation">
      <a href="index.html">In√≠cio</a>
      <a href="quem-somos.html">Quem Somos</a>
      <a href="entenda-problema.html">Problemas</a>
      <a href="educacao.html">Educa√ß√£o</a> 
      <a href="solucao.html">Solu√ß√µes</a>
      <a href="mapa-risco.html" style="color:var(--primary); font-weight:700;">Mapa</a>
      <a href="quiz.html">Quiz</a>
    </nav>

    <div class="hero">
      <div class="hero-content">
        <div class="brand-logos">
        <img src="assets/logo2.png" alt="Logo Lateral">
        <img src="assets/image.png" alt="Logo Principal">
        <img src="assets/alian√ßa.jpg" alt="Logo Lateral">
        <img src="assets/if.png" alt="Logo Lateral">
        </div>
        <h1 class="hero-title">Mapa de Risco</h1>
        <p class="hero-sub">An√°lise t√©cnica interativa das √°reas vulner√°veis e dados hist√≥ricos de alagamentos no Loteamento Alian√ßa.</p>
        <div class="hero-ctas">
          <a class="btn" href="#mapa-area" style="background:var(--accent); color:#000; padding:14px 32px; border-radius:50px; text-decoration:none; font-weight:700;">Explorar Mapa</a>
        </div>
      </div>
      <div class="hero-visual">
        <img src="assets/logo.png" alt="Ilustra√ß√£o Mapa">
      </div>
    </div>
  </header>

  <main id="content">

    <section id="mapa-area" class="section" style="background-color: var(--bg-section-map);">
      <div class="container">
        <h2>Georreferenciamento de Riscos</h2>
        <p style="margin-bottom: 20px; color: var(--text-muted);">
          <span style="display:inline-block; width:12px; height:12px; background:red; border-radius:50%; margin-right:5px;"></span>
          Use os bot√µes de <strong>+</strong> e <strong>-</strong> para dar zoom e arraste o mapa para navegar. Clique nos pontos vermelhos para detalhes.
        </p>
        
        <div class="map-wrapper">
          <div class="map-zoom-controls">
            <button class="map-zoom-btn" onclick="zoomMap(1.2)">+</button>
            <button class="map-zoom-btn" onclick="zoomMap(0.8)">-</button>
            <button class="map-zoom-btn" onclick="resetZoomMap()" style="font-size:1.2rem;">‚Ü∫</button>
          </div>

          <div class="map-container" id="mapContainer">
            <img src="assets/1767801836746.jpg" alt="Mapa A√©reo" class="base-map">

            <button class="hotspot" style="top: 40%; left: 66%;" onclick="openGallery('tv-sao-paulo')">
              <div class="hover-preview">
                <img src="assets/image_5d34c6.jpg" alt="Preview">
                <strong>Tv. S√£o Paulo</strong>
                <p>Obra inacabada</p>
              </div>
            </button>
            
            <button class="hotspot" style="top: 41%; left: 41%;" onclick="openGallery('nova-jerusalem')">
              <div class="hover-preview">
                <img src="assets/image_5d47a8.jpg" alt="Preview">
                <strong>R. Nova Jerusal√©m</strong>
                <p>Obstru√ß√£o total</p>
              </div>
            </button>

            <button class="hotspot" style="top: 41%; left: 70%;" onclick="openGallery('jose-luis')">
               <div class="hover-preview">
                <img src="assets/josel1.jpg" alt="Preview">
                <strong>R. Jos√© Luis</strong>
                <p>Manuten√ß√£o</p>
              </div>
            </button>
            
            <button class="hotspot" style="top: 74%; right: 70%;" onclick="openGallery('miguel-cervantes')">
               <div class="hover-preview">
                <img src="assets/cervantes.jpg" alt="Preview">
                <strong>Av. Miguel de Cervantes</strong>
                <p>Manuten√ß√£o</p>
              </div>
            </button>

            <button class="hotspot" style="top: 72%; right: 94%;" onclick="openGallery('lagoaca_capta√ßao')">
               <div class="hover-preview">
                <img src="assets/lagoa1.jpg" alt="Preview">
                <strong>Lagoa de Capta√ß√£o Alian√ßa</strong>
                <p>Lagoa de Capta√ß√£o</p>
              </div>
            </button>

            <button class="hotspot" style="top: 58%; right: 94%;" onclick="openGallery('couto-magalhaes')">
               <div class="hover-preview">
                <img src="assets/couto1.jpg" alt="Preview">
                <strong>Rua Couto Magalh√£es</strong>
                <p>Lagoa de Capta√ß√£o</p>
              </div>
            </button>

            <button class="hotspot" style="top: 64%; left: 56%;" onclick="openGallery('desembargador')"></button>
            <button class="hotspot" style="top: 71%; left: 43%;" onclick="openGallery('rizomar')"></button>
            <button class="hotspot" style="top: 15%; left: 81%;" onclick="openGallery('abmael')"></button>
            <button class="hotspot" style="top: 88%; left: 70%;" onclick="openGallery('joaquim')"></button>
          </div>
        </div>
      </div>
    </section>

    <section class="section" style="background-color: var(--bg-section-chart);">
      <div class="container">
        <h2>Frequ√™ncia de Alagamentos</h2>
        <div class="chart-container">
          <canvas id="alagamentoChart" style="width: 100%; height: 300px;"></canvas>
        </div>
      </div>
    </section>

    <section class="section" style="background-color: var(--bg-section-info);">
      <div class="container">
        <h2>Interpreta√ß√£o dos Dados</h2>
        <div class="risk-list">
          <div class="risk-item">
            <strong>üìà Tend√™ncia</strong>
            Aumento progressivo dos casos de alagamento nos √∫ltimos 4 anos.
          </div>
          <div class="risk-item">
            <strong>üöß Causalidade</strong>
            Impermeabiliza√ß√£o excessiva do solo e obras de drenagem incompletas.
          </div>
          <div class="risk-item">
            <strong>‚ö†Ô∏è Urg√™ncia</strong>
            A Rua Nova Jerusal√©m apresenta o maior risco de bloqueio total.
          </div>
        </div>
      </div>
    </section>

  </main>

  <footer class="footer">
    <div class="container">
      <p>¬© 2025 IFRN - Durmsgeo</p>
    </div>
  </footer>

  <div id="modalGallery" class="gallery-modal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeGallery()">&times;</button>
      <h3 id="modalTitle" style="color: var(--accent); margin-bottom: 10px;">Local</h3>
      <p id="modalDesc" style="margin-bottom: 20px; color: #ccc;">Descri√ß√£o</p>
      <div class="gallery-grid" id="galleryGridContainer"></div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <script>
    function toggleMobileMenu() {
      const menu = document.getElementById('mobileMenu');
      const backdrop = document.getElementById('mobileBackdrop');
      
      menu.classList.toggle('active');
      backdrop.classList.toggle('active');
    }

    let pageZoomLevel = 100;

    function toggleZoomMenu() {
        const menu = document.getElementById('globalZoomMenu');
        menu.classList.toggle('active');
    }

    function changeGlobalZoom(amount) {
        pageZoomLevel += amount;
        if (pageZoomLevel < 70) pageZoomLevel = 70;
        if (pageZoomLevel > 150) pageZoomLevel = 150;
        document.body.style.zoom = pageZoomLevel + "%";
    }

    function resetGlobalZoom() {
        pageZoomLevel = 100;
        document.body.style.zoom = "100%";
    }

    const locationsData = {
      'tv-sao-paulo': { title: 'Tv. S√£o Paulo', desc: 'Obra de saneamento aberta causando transtorno.', images: ['assets/image_5d34c6.jpg', 'assets/sp1.jpg'] },
      'nova-jerusalem': { title: 'R. Nova Jerusal√©m', desc: 'Interdi√ß√£o total da via com tapumes.', images: ['assets/image_5d47a8.jpg'] },
      'jose-luis': { title: 'R. Jos√© Lu√≠s da Silva', desc: 'Equipe de manuten√ß√£o avaliando o cal√ßamento.', images: ['assets/josel2.jpg', 'assets/josel1.jpg'] },
      'desembargador': { title: 'R. Desembargador Francisco', desc: '√Årea com alta reten√ß√£o de √°gua.', images: ['assets/image_81e148.jpg'] },
      'miguel-cervantes': { title: 'Av. Miguel de Cervantes', desc: 'Manuten√ß√£o', images: ['assets/cervantes1.jpg', 'assets/cervantes2.jpg'] },
      'lagoaca_capta√ßao': { title: 'Lagoa de Capta√ß√£o Alian√ßa', desc: 'Lagoa', images: ['assets/lagoa1.jpg', 'assets/lagoa2.jpg'] },
      'couto-magalhaes': { title: 'Rua Couto Magalh√£es', desc: 'Manuten√ß√£o', images: ['assets/couto1.jpg', 'assets/couto2.jpg'] },
      'rizomar': { title: 'R. Rizomar Correia', desc: 'A √°gua invade as cal√ßadas.', images: ['assets/rizomar2.jpg', 'assets/rizomar1.jpg'] },
      'abmael': { title: 'R. Abmael Florencio', desc: 'Hist√≥rico de alagamento r√°pido.', images: ['assets/image_81e7ec.jpg'] },
      'joaquim': { title: 'R. Dep. Joaquim In√°cio', desc: 'Buracos cobertos pela √°gua.', images: ['assets/image_81e80f.jpg'] }
    };

    const mapContainer = document.getElementById('mapContainer');
    let escalaMapa = 1;
    let isArrastando = false;
    let inicioX, inicioY;
    let translateX = 0, translateY = 0; 
    let ultimoTranslateX = 0, ultimoTranslateY = 0;

    function atualizarTransformacaoMapa() {
      mapContainer.style.transform = `translate(${translateX}px, ${translateY}px) scale(${escalaMapa})`;
    }

    function zoomMap(fator) {
      escalaMapa *= fator;
      if (escalaMapa < 1) escalaMapa = 1; 
      if (escalaMapa > 4) escalaMapa = 4; 
      if (escalaMapa === 1) { translateX = 0; translateY = 0; ultimoTranslateX = 0; ultimoTranslateY = 0; }
      atualizarTransformacaoMapa();
    }

    function resetZoomMap() {
      escalaMapa = 1; translateX = 0; translateY = 0; ultimoTranslateX = 0; ultimoTranslateY = 0;
      atualizarTransformacaoMapa();
    }
    
    mapContainer.addEventListener('mousedown', (e) => {
      if (escalaMapa > 1) { 
        isArrastando = true; inicioX = e.clientX - ultimoTranslateX; inicioY = e.clientY - ultimoTranslateY; mapContainer.style.cursor = 'grabbing';
      }
    });

    window.addEventListener('mouseup', () => {
      isArrastando = false; ultimoTranslateX = translateX; ultimoTranslateY = translateY; mapContainer.style.cursor = 'grab';
    });

    window.addEventListener('mousemove', (e) => {
      if (!isArrastando) return;
      e.preventDefault(); translateX = e.clientX - inicioX; translateY = e.clientY - inicioY;
      atualizarTransformacaoMapa();
    });

    function openGallery(key) {
      const data = locationsData[key];
      if (!data) return;
      document.getElementById('modalTitle').innerText = data.title;
      document.getElementById('modalDesc').innerText = data.desc;
      const grid = document.getElementById('galleryGridContainer');
      grid.innerHTML = ''; 
      data.images.forEach(imgSrc => {
        const img = document.createElement('img');
        img.src = imgSrc; 
        img.onerror = () => { console.log("Imagem n√£o encontrada: " + imgSrc) };
        grid.appendChild(img);
      });
      document.getElementById('modalGallery').style.display = 'flex';
    }

    function closeGallery() { document.getElementById('modalGallery').style.display = 'none'; }

    const themeBtn = document.getElementById('themeToggle');
    const htmlEl = document.documentElement;
    let myChart = null; 

    const savedTheme = localStorage.getItem('theme');
    const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    
    if (savedTheme) { htmlEl.setAttribute('data-theme', savedTheme); } 
    else if (!systemPrefersDark) { htmlEl.setAttribute('data-theme', 'light'); }

    themeBtn.addEventListener('click', () => {
      const currentTheme = htmlEl.getAttribute('data-theme');
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      htmlEl.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
      updateChartColors(); 
    });

    function getChartColors() {
      const style = getComputedStyle(document.body);
      return { grid: style.getPropertyValue('--chart-grid').trim(), text: style.getPropertyValue('--chart-text').trim() };
    }

    function updateChartColors() {
      if (!myChart) return;
      const colors = getChartColors();
      myChart.options.scales.x.grid.color = colors.grid;
      myChart.options.scales.x.ticks.color = colors.text;
      myChart.options.scales.y.grid.color = colors.grid;
      myChart.options.scales.y.ticks.color = colors.text;
      if (myChart.options.plugins && myChart.options.plugins.legend) { myChart.options.plugins.legend.labels.color = colors.text; }
      myChart.update();
    }

    window.onload = function() {
      const ctx = document.getElementById('alagamentoChart');
      if (ctx) {
        const colors = getChartColors();
        let gradient = ctx.getContext('2d').createLinearGradient(0, 0, 0, 400);
        gradient.addColorStop(0, 'rgba(5, 223, 52, 0.5)'); 
        gradient.addColorStop(1, 'rgba(5, 223, 52, 0)');

        myChart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: ['2020', '2021', '2022', '2023', '2024'],
            datasets: [{
              label: 'Ocorr√™ncias Registradas',
              data: [5, 8, 12, 15, 22],
              borderColor: '#05df34', 
              backgroundColor: gradient,
              fill: true,
              tension: 0.3,
              pointBackgroundColor: '#fff',
              pointBorderColor: '#05df34'
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: { 
                y: { beginAtZero: true, grid: { color: colors.grid }, ticks: { color: colors.text } },
                x: { grid: { color: colors.grid }, ticks: { color: colors.text } }
            },
            plugins: { legend: { labels: { color: colors.text } } }
          }
        });
      }
    }
  </script>

</body>
</html>